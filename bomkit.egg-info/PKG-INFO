Metadata-Version: 2.4
Name: bomkit
Version: 0.1.0
Summary: Open-source toolkit for parsing and normalizing Bills of Materials
Author-email: Ethan Rozee <ethanrozee01@gmail.com>
License: MIT License
        
        Copyright (c) 2025 erozee1
        
        Permission is hereby granted, free of charge, to any person obtaining a copy
        of this software and associated documentation files (the "Software"), to deal
        in the Software without restriction, including without limitation the rights
        to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
        copies of the Software, and to permit persons to whom the Software is
        furnished to do so, subject to the following conditions:
        
        The above copyright notice and this permission notice shall be included in all
        copies or substantial portions of the Software.
        
        THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
        IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
        FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
        AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
        LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
        OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
        SOFTWARE.
        
Project-URL: Homepage, https://github.com/erozee1/bomkit
Project-URL: Documentation, coming soon
Project-URL: Bug Tracker, https://github.com/erozee1/bomkit/issues
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: openpyxl
Requires-Dist: chardet
Requires-Dist: pint
Dynamic: license-file

# bomkit

An open-source toolkit for parsing and normalizing Bills of Materials (BOMs). Transform messy, inconsistent BOM files into perfectly standardized documents with a single command.

## Features

- **Multi-format Support**: Parse CSV, Excel, and PDF files
- **Intelligent Column Matching**: 
  - Lexical similarity matching (handles typos, abbreviations, variations)
  - Column profiling (disambiguates ambiguous columns using data patterns)
  - Exact matching for known variations
- **Unit Normalization**: Converts all units to SI engineering units
- **Reference Designator Normalization**: Standardizes formats (e.g., "R1, R2, R3" → "R1-R3")
- **Standard Template**: All BOMs normalized to consistent column structure

## Quick Start

### Single Command Normalization

The easiest way to normalize a BOM is using the `normalize_complete()` method:

```python
from bomkit import BomParser
from bomkit.adapters.csv_adapter import CsvAdapter
from bomkit.adapters.excel_adapter import ExcelAdapter

# Initialize parser with all features
parser = BomParser(
    normalize=True,                    # Column normalization
    normalize_units=True,             # Unit normalization
    use_lexical_similarity=True,      # Handle typos & abbreviations
    use_column_profiling=True         # Disambiguate columns
)

# Register adapters
parser.register_adapter(CsvAdapter())
parser.register_adapter(ExcelAdapter())

# Single command to normalize everything!
normalized_bom = parser.normalize_complete(
    input_path='messy_bom.csv',
    output_path='clean_bom.xlsx'
)
```

### What Gets Fixed

**Column Names:**
- ✅ Typos: `"quantitiy"` → `"quantity"`
- ✅ Abbreviations: `"qty"` → `"quantity"`, `"mfg"` → `"manufacturer"`
- ✅ Variations: `"part number"`, `"Part_Number"`, `"part-number"` → `"part_number"`
- ✅ Case issues: `"MANUFACTURER"` → `"manufacturer"`

**Data:**
- ✅ Units: `"10nF"`, `"10 nF"`, `"10n"` → normalized to SI base units
- ✅ Reference designators: `"R1, R2, R3"` → `"R1-R3"`
- ✅ Missing columns: Added with empty values
- ✅ Extra columns: Preserved in `notes` field

## How It Works

The normalization pipeline consists of four stages:

1. **File Parsing** - Reads BOM files using format-specific adapters
2. **Column Name Normalization** - Three complementary techniques:
   - Exact matching against known variations
   - Lexical similarity (for natural language columns)
   - Column profiling (for ambiguous columns)
3. **Data Normalization** - Units, reference designators, formatting
4. **Export** - Outputs standardized BOM

### Lexical Similarity Features

For headers and natural language columns, bomkit uses:

1. **Text Normalization**: Lowercase, punctuation stripping, token unification
2. **Edit Distance / Jaro-Winkler**: Handles typos in short labels
3. **Token Similarity**: Jaccard and cosine similarity over token sets
4. **Abbreviation Expansion**: Curated dictionary (qty→quantity, mfg→manufacturer)
5. **Spell-Check**: Fast correction for common typos

**Note**: Lexical similarity is **not** applied to non-natural language columns like `part_number` and `manufacturer_part_number` to avoid false positives.

### Column Profiling

For ambiguous columns (e.g., "Value" could be electrical value, cost, or declared value), bomkit uses statistical analysis:

- Type distribution (numeric vs. text)
- Pattern matching (MPN patterns, reference designator patterns)
- Unit detection (electrical units like V, A, uF, Ω)
- Length statistics

## Standard Output Template

All normalized BOMs use this standard column order:

1. `part_number` - Internal part identifier
2. `description` - Component description
3. `quantity` - Number of units required
4. `unit` - Unit of measure
5. `manufacturer` - Manufacturer name
6. `manufacturer_part_number` - Manufacturer's part number
7. `reference_designator` - Schematic reference
8. `value` - Electrical value or specification
9. `package` - Package type/footprint
10. `notes` - Additional information

## Installation

```bash
pip install bomkit
```

## Examples

See `examples/complete_normalization.py` for a complete example.

## Documentation

For detailed documentation on the normalization pipeline, see [docs/NORMALIZATION_PIPELINE.md](docs/NORMALIZATION_PIPELINE.md).

## License

See LICENSE file.
